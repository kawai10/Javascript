# CPU 스케줄링

## CPU 스케줄링이란

- CPU 스케줄러는 프로세스가 생성된 후 종료될 때까지 모든 상태 변화를 조정하는 일을 하며, CPU스케줄링은 CPU스케줄러가 하는 모든 작업을 가리킨다.

## 스케줄링의 단계

- 고수준 스케줄링 : 시스템 내의 전체 프로세스 수를 조절하는 것
- 중간 수준 스케줄링 : 전체 시스템의 활성화된 프로세스 수를 조절하여 과부하를 막는 것.
- 저수준 스케줄링 : 어떤 프로세스에 CPU를 할당할지, 어떤 프로세스를 대기 상태로 보낼지 등을 결정하는 것.

## 스케줄링의 목적

- 공평성 : 모든 프로세스가 자원을 공평하게 배정받아야 하며, 자원 배정 과정에서 특정 프로세스가 배제되어서는 안 된다.
- 효율성 : 시스템 자원이 유휴 시간 없이 사용되도록 스케줄링을 하고, 유휴 자원을 사용하려는 프로세스에는 우선권을 주어야 한다.
- 안정성 : 우선순위를 사용하여 중요 프로세스가 먼저 작동하도록 배정함으로써 시스템 자원을 점유하거나 파괴하려는 프로세스로부터 자원을 보호해야 한다.
- 확장성 : 프로세스가 증가해도 시스템이 안정적으로 작동하도록 조치해야 한다. 시스템 자원이 늘어나는 경우 이 혜택이 시스템에 반영되어야 한다.
- 반응 시간 보장 : 응답이 없는 경우 사용자는 시스템이 멈춘 것으로 가정하기 때문에 시스템은 적절한 시간 안에 프로세스의 요구에 반응해야 한다.
- 무한 연기 방지 : 특정 프로세스의 작업이 무한히 연기되어서는 안 된다.

## 스케줄링 시 고려 사항

- 우선순위가 높은 프로세스에 CPU를 먼저 할당한다. 우선순위가 높은 프로세스는 커널 프로세스, 전면 프로세스, 대화형 프로세스, 입출력 프로세스이고, 우선순위가 낮은 프로세스는 일반 프로세스, 후면 프로세스, 일괄 작업 프로세스, CPU 집중 프로세스이다.

## 다중 큐

- 프로세스를 효율적으로 관리하기 위해 큐를 여러 개 두어 관리하는 것을 말한다. 준비 상태에서는 우선순위에 따라 다중 큐를 운영하고, 대기 상태에서는 같은 입출력을 요구한 프로세스들을 모아 다중 큐를 운영한다.

## 스케줄링 알고리즘

1. 개요
   - 스케줄링 알고리즘은 비선점형 알고리즘과 선점형 알고리즘으로 나뉨.  
     비선점형 알고리즘은 프로세스가 CPU를 할당받으면 작업이 끝날때까지 CPU를 놓지 않기 때문에 효율이 떨어져서 지금은 거의 사용하지 않음  
     선점형 알고리즘은 시분할 시스템을 고려하여 만들어진 알고리즘으로, 어떤 프로세스가 CPU를 할당받아 실행 중이라도 운영체제가 CPU를 강제로 빼앗을 수 있다.
2. 종류
   - 스케줄링 알고리즘의 종류
     1. 비선점형 알고리즘
        - FCFS 스케줄링, SJF 스케줄링, HRN 스케줄링, 우선순위 스케줄링
     2. 선점형 알고리즘
        - 라운드 로빈 스케줄링, SRT 스케줄링, 다단계 큐 스케줄링, 다단계 피드백 큐 스케줄링, 우선순위 스케줄링

## 비선점형 알고리즘

**1. FCFS 스케줄링**

1.  개요
    - 준비 큐에 도착한 순서대로 CPU를 할당하는 비선점형 스케줄링 방식
2.  성능
    - 프로세스 P1,P2,P3 가 준비 큐에 순서대로 도착했다고 가정  
      P1은 0밀리초, P2는 3밀리초, P3는 6밀리초에 도착했고 각 작업시간은 P1이 30밀리초, P2가 18밀리초, P3이 9밀리초일 경우  
      P1은 대기 시간이 0밀리초, 작업 시간은 30밀리초.  
      P2는 27(30-3)밀리초를 기다린 후 18밀리초 동안 실행.
      P3은 42(48-6)를 기다린 후 9밀리초 동안 실행.  
      3개 프로세스의 평균 대기 시간은 (0+27+42) / 3 = 23밀리초

**2. SJF 스케줄링**

1.  개요
    - 준비 큐에 있는 프로세스 중에서 실행 시간이 가장 짧은 작업부터 CPU를 할당하는 방식.
2.  성능
    - P1은 0밀리초 도착, 30밀리초 작업.  
      P2는 3밀리초 도착, 18밀리초 작업.  
      P3는 6밀리초 도착, 9밀리초 작업.  
      P1의 대기시간은 0밀리초.  
      P3의 작업이 짧기 때문에 P3가 먼저 시작.  
      P3의 대기시간은 24밀리초.  
      P2의 대기시간은 36밀리초.  
      평균 대기 시간은 (0+24+36) / 3 = 20밀리초

**3. HRN 스케줄링**

1.  개요
    - CPU를 할당받기 위해 기다린 시간과 CPU 사용 시간을 고려하여 스케줄링을 하는 비선점형 방식.
2.  성능
    - 프로세스 P1,P2,P3가 위의 SJF 스케줄링과 같다고 가정했을 때 HRN 스케줄링은 SJF 스케줄링에서 발생할 수 있는 아사 현상을 해결하기 위해 만들어진 알고리즘으로 대기 시간과 CPU 사용 시간을 고려하여 우선순위를 판단한다.
      P2의 우선순위는 대기시간(27) + CPU 사용 시간(18) / CPU 사용 시간(18) = 2.5이고  
      P3의 우선순위는 대기시간(24) + CPU 사용 시간(9) / CPU 사용 시간(9) = 3.67

**4. 우선순위 스케줄링**

1.  개요

    - 프로세스는 중요도에 따라 우선순위를 갖는데 이러한 우선순위를 반영하여 CPU를 할당하는 방식.

2.  성능

## 선점형 알고리즘

**1. 라운드 로빈 스케줄링**

1.  개요
    - 한 프로세스가 할당받은 시간(타임 슬라이스) 동안 작업을 하다가 작업을 완료하지 못하면 준비 큐의 맨 뒤로 가서 자기 차례를 기다리는 선점형 방식
2.  성능

**2. SRT 스케줄링**

1.  개요
    - 기본적으로 라운드 로빈 스케줄링을 사용하지만, CPU를 할당받을 프로세스를 선택할 때 남아 있는 작업 시간이 가장 적은 프로세스를 선택하는 선점형 방식.
2.  성능

**3. 다단계 큐 스케줄링**

1.  개요
    - 우선순위에 따라 준비 큐를 여러 개 사용하는 비선점형 방식.  
      프로세스는 운영체제로부터 부여받은 우선순위에 따라 해당 우선순위의 큐에 삽입되어 실행된다.
2.  성능

**4. 다단계 피드백 큐 스케줄링**

1.  개요
    - 다단계 큐 스케줄링과 기본적인 형태가 같지만, CPU를 사용하고 난 프로세스가 원래의 큐로 되돌아가지 않고 우선순위가 낮은 큐의 끝으로 들어가는 것.
2.  성능
